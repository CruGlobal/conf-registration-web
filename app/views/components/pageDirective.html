<div ng-if="wizard">
  <a id="page{{$index + 1}}"></a>
  <div class="panel panel-default">
    <div class="panel-heading">
      <div class="row">
        <div class="col-sm-8 stacked-spacing-col-sm">
          <div class="input-group input-group-lg">
            <span class="input-group-addon">Page {{$index + 1}}</span>
            <input class="form-control" type="text" placeholder="Page Title" ng-model="page.title">
          </div>
        </div>
        <div class="col-sm-4 text-right">
          <a href="" ng-click="deletePage(page.id, true)"><i class="fa fa-trash-o fa-inset"></i></a>
          <a href="" ng-click="togglePage(page.id)"><i class="fa fa-inset" ng-class="{'fa-chevron-up': !isPageHidden(page.id), 'fa-chevron-down': isPageHidden(page.id)}"></i></a>
          <i class="fa fa-bars fa-inset" ui-tree-handle></i>
        </div>
      </div>
    </div>
    <ul ui-tree-nodes ng-model="page.blocks" class="list-group" id="{{page.id}}" ng-if="!isPageHidden(page.id)" drop-type="block">
      <li ui-tree-node class="list-group-item" ng-repeat="block in page.blocks" block="block" crs-block  ng-class="{'admin-only': block.adminOnly}"></li>
    </ul>
    <div class="panel-footer dropNewTarget" ng-if="!isPageHidden(page.id) && (page.blocks.length <= 0 || page.blocks.length <= 2 && $first)">
      <i class="fa fa-plus-circle"></i>
      <p>Drag form elements here!</p>
    </div>
  </div>
</div>

<div ng-if="!wizard">
  <article>
    <h2 class="page-title border" ng-bind="page.title"></h2>

    <form novalidate>
      <div ng-repeat="block in page.blocks" block="block" crs-block ng-show="blockVisible(block)"></div>
      <div class="row spacing-above-md">
        <div class="col-sm-3 col-xs-5">
          <button class="btn btn-subtle btn-lg btn-block"
                  type="button"
                  ng-disabled="savingAnswers"
                  ng-click="previousPage()">
            Go Back
          </button>
        </div>
        <div class="col-sm-9 col-xs-7">
          <button class="btn btn-success btn-important btn-lg btn-block"
                  type="submit"
                  ng-disabled="savingAnswers"
                  ng-click="goToNext()">
            <span ng-show="!savingAnswers && !nextPage()">Continue</span>
            <span ng-show="!savingAnswers && nextPage()">Next Page</span>
            <span ng-show="savingAnswers">Saving...</span>
          </button>
        </div>
      </div>
    </form>
  </article>
</div>
