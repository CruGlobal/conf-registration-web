<div class="row">
  <div class="col-xs-12">
    <div class="alert" ng-class="notify.class" ng-bind-html="notify.message" ng-show="notify.class"></div>

    <h3 ng-if="requestedPermissions.length">Pending Requests</h3>
    <div class="table-responsive" ng-show="requestedPermissions.length">
      <table class="table table-striped">
        <thead>
        <tr>
          <th class="col-xs-7">User</th>
          <th class="col-xs-2">Level</th>
          <th class="col-xs-2">Requested</th>
          <th class="col-xs-1">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="permission in requestedPermissions = (currentPermissions | filter:{ permissionLevel: 'REQUESTED' }) | orderBy: ['lastName', 'firstName', 'emailAddress']">
          <td>
            <span ng-if="permission.firstName || permission.lastName">{{permission.lastName}}, {{permission.firstName}} |&nbsp;</span>{{permission.emailAddress}}
            <span ng-if="permission.reasonForRequest">
              <br><strong>Reason: </strong>{{permission.reasonForRequest}}
            </span>
          </td>
          <td>
            <select style="min-width:128px;" ng-model="permission.permissionLevel" ng-change="updatePermission(permission.id)" class="form-control">
              <option value="FULL">Full</option>
              <option value="UPDATE">Update</option>
              <option value="SCHOLARSHIP">Scholarship</option>
              <option value="VIEW">View</option>
              <option ng-if="permission.permissionLevel === 'REQUESTED'" value="REQUESTED">Requested</option>
            </select>
          </td>
          <td>{{permission.timestamp | date:'short'}}</td>
          <td><a href="" ng-click="deletePermission(permission.id)" class="btn btn-danger btn-sm">Delete</a></td>
        </tr>
        </tbody>
      </table>
    </div>

    <h3 ng-show="pendingPermissions.length">Pending Invites</h3>
    <div class="table-responsive" ng-show="pendingPermissions.length">
      <table class="table table-striped">
        <thead>
        <tr>
          <th>Email</th>
          <th class="col-xs-2">Level</th>
          <th class="col-xs-2">Email Sent</th>
          <th style="width:200px;" class="text-center">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="permission in pendingPermissions = (currentPermissions | filter:{ permissionLevel: '!REQUESTED', userId: '!' }) | orderBy: ['lastName', 'firstName', 'emailAddress']">
          <td>
            <span ng-if="permission.firstName || permission.lastName">{{permission.lastName}}, {{permission.firstName}} |&nbsp;</span>{{permission.emailAddress}}
          </td>
          <td>
            {{permission.permissionLevel}}
          </td>
          <td>{{permission.timestamp | date:'short'}}</td>
          <td class="text-center">
            <a href="" ng-click="resendEmail(permission)" class="btn btn-default btn-sm">Resend Email</a>
            <a href="" ng-click="deletePermission(permission.id)" class="btn btn-danger btn-sm">Delete</a>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <h3>Add User</h3>
    <div class="row">
      <div class="col-sm-6">
        <strong>Email</strong>
        <input type="text" class="form-control" placeholder="example@example.com" ng-model="addPermissionsEmail">
      </div>
      <div class="col-sm-4">
        <strong>Permission Level</strong>
        <select ng-model="addPermissionsLevel" class="form-control">
          <option value="FULL">Full</option>
          <option value="UPDATE">Update</option>
          <option value="SCHOLARSHIP">Scholarship</option>
          <option value="VIEW">View</option>
        </select>
      </div>
      <div class="col-sm-2 text-center">
        <br>
        <button type="button" class="btn btn-success btn-block" ng-click="addPermission(addPermissionsEmail, addPermissionsLevel)">Send</button>
      </div>
    </div>

    <h3>Current Users</h3>
    <div class="table-responsive">
      <table class="table table-striped">
        <thead>
        <tr>
          <th class="col-xs-7">User</th>
          <th class="col-xs-2">Level</th>
          <th class="col-xs-2">Last Update</th>
          <th class="col-xs-1">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="permission in currentPermissions | filter:{ permissionLevel: '!REQUESTED', userId: '' } | orderBy: ['lastName', 'firstName', 'emailAddress']">
          <td>
            <span ng-if="permission.firstName || permission.lastName">{{permission.lastName}}, {{permission.firstName}} |&nbsp;</span>{{permission.emailAddress}}
            <span ng-if="!permission.userId" class="text-muted"><br>Pending acceptance</span>
          </td>
          <td>
            <select style="min-width:128px;" ng-model="permission.permissionLevel" ng-change="updatePermission(permission.id)" class="form-control">
              <option ng-if="permission.permissionLevel === 'CREATOR'" value="CREATOR">Creator</option>
              <option value="FULL">Full</option>
              <option value="UPDATE">Update</option>
              <option value="SCHOLARSHIP">Scholarship</option>
              <option value="VIEW">View</option>
            </select>
          </td>
          <td>{{permission.timestamp | date:'short'}}</td>
          <td><a href="" ng-click="deletePermission(permission.id)" class="btn btn-danger btn-sm">Delete</a></td>
        </tr>
        </tbody>
      </table>
    </div>

    <h3>Permission level comparison</h3>
    <div class="table-responsive">
      <table class="table">
        <thead>
        <tr>
          <th></th>
          <th style="width:140px;" class="text-center">Requested</th>
          <th style="width:140px;" class="text-center">View</th>
          <th style="width:140px;" class="text-center">Scholarship</th>
          <th style="width:140px;" class="text-center">Update</th>
          <th style="width:140px;" class="text-center">Full/Creator</th>
        </tr>
        </thead>
        <tbody>
        <tr class="active">
          <th colspan="6">Event</th>
        </tr>
        <tr>
          <td>Update/modify event details</td>
          <td></td>
          <td></td>
          <td></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
        </tr>
        <tr>
          <td>Edit/modify event questions</td>
          <td></td>
          <td></td>
          <td></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
        </tr>
        <tr>
          <td>Add/modify event users</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
        </tr>
        <tr>
          <td>Clone event</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
        </tr>
        <tr>
          <td>Archive/delete event</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
        </tr>
        <tr class="active">
          <th colspan="6">Registrations</th>
        </tr>
        <tr>
          <td>View/export registrations</td>
          <td></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
        </tr>
        <tr>
          <td>Add/modify/delete registrations</td>
          <td></td>
          <td></td>
          <td></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
        </tr>
        <tr class="active">
          <th colspan="6">Payments and Expenses</th>
        </tr>
        <tr>
          <td>View/export payments</td>
          <td></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
        </tr>
        <tr>
          <td>Manage/add scholarship payments</td>
          <td></td>
          <td></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
        </tr>
        <tr>
          <td>Manage/add all payments</td>
          <td></td>
          <td></td>
          <td></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
        </tr>
        <tr>
          <td>Manage/add expenses and discounts</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td class="text-center"><i class="fa fa-check"></i></td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
